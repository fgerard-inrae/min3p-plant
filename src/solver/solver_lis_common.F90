!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/solver/solver_lis_common.F90 $
!---------------------------------------------------------------------
!********************************************************************!

#ifdef LIS

!> module: solver_lis_common
!>
!> written by: Danyang Su
!>
!> module description:
!>
!> Module of solver variables/parameters for lis 
!> (Library of Iterative Solvers for linear systems, pronounced [lis])
!>
!> Note:  
!> See http://www.ssisc.org/lis/index.en.html for detail


module solver_lis_common

    implicit none

#include "lisf.h"

    !> Variables of flow problem
    !> all the varialbes have prefix lis_ compared to the variables used in PETSc

    !> Solver 
    LIS_SOLVER :: lis_solver_flow

    !> Solution
    LIS_VECTOR :: lis_x_flow

    !> Right hand side
    LIS_VECTOR :: lis_b_flow

    !> Jacobian matrix
    LIS_MATRIX :: lis_a_flow

    !> Solver parameters for flow

    !> Maximum iterations
    LIS_INTEGER :: lis_maxit_flow

    !> Residual norm
    LIS_REAL :: lis_abstol_flow

    !> Solver options for flow
    character(1024) :: lis_options_flow

    !> Default solver options for flow
    logical :: lis_default_flow

    !c MIN3P local matrix pointer with ghost nodes to 
    !c global matrix pointer without ghost nodes
    !c for flow problem, (c)->(b) in gen file
    integer, allocatable :: lis_ia_lg2pg_flow(:)
    integer, allocatable :: lis_ja_lg2pg_flow(:)
    !> nonzero entries for the global matrix installed in the local processor
    LIS_INTEGER :: lis_nnz_flow
    !> Jacobian matrix value
    LIS_SCALAR, allocatable :: lis_matvalue_flow(:)

    !> local solution array for flow, without ghost nodes
    LIS_SCALAR, allocatable :: lis_x_flow_loc(:)

    !> global solution array for flow
    LIS_SCALAR, allocatable :: lis_x_flow_gbl(:)

    !> Variables of decoupled heat problem
    !> all the varialbes have prefix lis_ compared to the variables used in PETSc

    !> Solver 
    LIS_SOLVER :: lis_solver_heat

    !> Solution
    LIS_VECTOR :: lis_x_heat

    !> Right hand side
    LIS_VECTOR :: lis_b_heat

    !> Jacobian matrix
    LIS_MATRIX :: lis_a_heat

    !> Solver parameters for heat

    !> Maximum iterations
    LIS_INTEGER :: lis_maxit_heat

    !> Residual norm
    LIS_REAL :: lis_abstol_heat

    !> Solver options for heat
    character(1024) :: lis_options_heat

    !> Default solver options for heat
    logical :: lis_default_heat

    !c MIN3P local matrix pointer with ghost nodes to 
    !c global matrix pointer without ghost nodes
    !c for heat problem, (c)->(b) in gen file
    integer, allocatable :: lis_ia_lg2pg_heat(:)
    integer, allocatable :: lis_ja_lg2pg_heat(:)
    !> nonzero entries for the global matrix installed in the local processor
    LIS_INTEGER :: lis_nnz_heat
    !> Jacobian matrix value
    LIS_SCALAR, allocatable :: lis_matvalue_heat(:)

    !> local solution array for heat, without ghost nodes
    LIS_SCALAR, allocatable :: lis_x_heat_loc(:)

    !> global solution array for heat
    LIS_SCALAR, allocatable :: lis_x_heat_gbl(:)   

    !> Variables of reactive transport problem
    !> all the varialbes have prefix lis_ compared to the variables used in PETSc

    !> Solver 
    LIS_SOLVER :: lis_solver_react

    !> Solution
    LIS_VECTOR :: lis_x_react

    !> Right hand side
    LIS_VECTOR :: lis_b_react

    !> Jacobian matrix
    LIS_MATRIX :: lis_a_react

    !> Solver parameters for reactive transport

    !> Maximum iterations
    LIS_INTEGER :: lis_maxit_react

    !> Residual norm
    LIS_REAL :: lis_abstol_react

    !> Solver options for reactive transport
    character(1024) :: lis_options_react

    !> Default solver options for reactive transport problem
    logical :: lis_default_react

    !c MIN3P local matrix pointer with ghost nodes to 
    !c global matrix pointer without ghost nodes
    !c for reactive transport problem, (c)->(b) in gen file
    integer, allocatable :: lis_ia_lg2pg_react(:)
    integer, allocatable :: lis_ja_lg2pg_react(:)
    !> nonzero entries for the global matrix installed in the local processor
    LIS_INTEGER :: lis_nnz_react
    !> Jacobian matrix value
    LIS_SCALAR, allocatable :: lis_matvalue_react(:)

     !> local solution array for reactive transport, without ghost nodes
    LIS_SCALAR, allocatable :: lis_x_react_loc(:)

    !> global solution array for reactive transport
    LIS_SCALAR, allocatable :: lis_x_react_gbl(:)

end module solver_lis_common

#endif
