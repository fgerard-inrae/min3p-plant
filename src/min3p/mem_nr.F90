!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/mem_nr.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_nr
!c -----------------
!c
!c allocate memory for one-dimensional arrays of size nr and related 
!c arrays
!c
!c written by:      Uli Mayer - January 7, 2000
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:
!c gen.f:    integer:
!c           --------
!c           ilog               = unit number, logbook file           + -
!c
!c chem.f:   real*8:
!c           -------
!c           bcatfac(nr*nor)    = bacterial catalysis factor          * +
!c           chomc(nr*nor*nc)   = cutoff concentrations for reacting  * +
!c                                species (components as species
!c                                in solution)
!c           chomt(nr*nor*nc)   = cutoff concentration for reacting   * +
!c                                species (total aqueous component
!c                                concentrations)
!c           chomx(nr*nor*nx)   = cutoff concentration for reacting   * +
!c                                species (aqueous complexes)
!c           dhcr(nr)           = enthalpy change for redox reaction  * +
!c           eqr(nr,nthreads)   = equilibrium constant for redox      * +
!c                                couple reaction equation
!c           eqrs(nr)           = equilibrium constant for redox      * +
!c                                for standard temperature
!c                                couple reaction equation
!c           ordorc(nr*nor*nc)  = order of oxidation-reduction        * +
!c                                reaction with respect to components
!c                                as species in solution
!c           ordort(nr*nor*nc)  = order of oxidation-reduction        * +
!c                                reaction with respect to total
!c                                aqueous component concentrations
!c           ordorx(nr*nor*nx)  = order of oxidation-reduction        * +
!c                                reaction with respect to
!c                                secondary aqueous species
!c           rateor(nr,nthreads)= oxidation-reduction rate for        * +
!c                                redox couple [moles/(l h2o*day)
!c           rateox(nr*nor)     = log of oxidation-reduction rate     * +
!c                                constant
!c                                (units: liter -  moles - seconds)
!c           xnur(nr*nc)        = stoichiometric coefficient of       * +
!c                                components in redox couple
!c                                reaction equation
!c
!c           integer:
!c           --------
!c           iaor(nr+1)         = pointer array to parallel           * +
!c                                oxidation/reduction reactions
!c           iaorc(nr*nor+1)    = row pointer array to reactants      * +
!c                                in parallel oxidation-reduction
!c                                reactions (components as species
!c                                in solution)
!c           iaort(nr*nor+1)    = row pointer array to reactants      * +
!c                                in parallel oxidation-reduction
!c                                reactions (total aqueous component
!c                                concentrations)
!c           iaorx(nr*nor+1)    = row pointer array to reactants      * +
!c                                in parallel oxidation-reduction
!c                                reactions (secondary aqueous
!c                                species)
!c           iarc(nr+1)         = row pointer array to                * +
!c                                stoichiometric coefficients of
!c                                components in redox reaction
!c           iars(nr)           = pointer array to secondary          * +
!c                                component of redox couple
!c           jaorc(nr*nor*nc)   = column pointer array to reactants   * +
!c                                in parallel oxidation-reduction
!c                                reactions (components as species
!c                                in solution)
!c           jaort(nr*nor*nc)   = column pointer array to reactants   * +
!c                                in parallel oxidation-reduction
!c                                reactions (total aqueous component
!c                                concentrations)
!c           jaorx(nr*nor*nx)   = column pointer array to reactants   * +
!c                                in parallel oxidation-reduction
!c                                reactions (secondary aqueous
!c                                species)
!c           jarc(nr*nc)        = column pointer array to             * +
!c                                stoichiometric coefficients of
!c                                components in redox reaction
!c           l_namer(nr)        = length of names of redox couples    * +
!c           l_namerp(nr)       = length of names of primary          * +
!c                                components of redox couples
!c           l_namers(nr)       = length of names of secondary        * +
!c                                components of redox couples
!c           nc                 = number of components including h2o  + -
!c           nr                 = number of redox couples             + -
!c
!c           character:
!c           ----------
!c           namer(nr)          = names of redox couples              * +
!c           namerp(nr)         = names of primary components of      * +
!c                                redox couples
!c           namers(nr)         = names of secondary components of    * +
!c                                redox couples
!c           rtype_hom(nr)      = reaction type of homogeneous        * +
!c                                reaction in aqueous phase
!c                                'forward'
!c                                'backward'
!c                                'forward-to-equilibrium'
!c                                'backward-to-equilibrium'
!c                                'reversible'
!c                                'equilibrium'
!c
!c local:    integer:
!c           --------
!c           ierr               = 0 -> memory allocation successful
!c
!c external: checkerr  = check for error during memory allocation
!c
!c---------------------------------------------------------------------- 
!c WARNING
!c---------------------------------------------------------------------- 
!c All allocated variables are initialized to some value. This depends  
!c of its type:
!c 
!c real*8      => 0.0d0
!c integer     => 0 
!c character   => ' '    
!c logical     => .false. 
!c 
!c Sergio Andres Bea Jofre (2009)
!c
!c ----------------------------------------------------------------------
  
      subroutine mem_nr
 
      use parm
      use gen
      use chem
 
      implicit none
      
      integer :: ierr
      
      external checkerr

!c  main variables - oxidation reduction

      allocate (bcatfac(nr*maxnor), stat = ierr)
      bcatfac=0.0d0
      call checkerr(ierr,'bcatfac',ilog)
      call memory_monitor(sizeof(bcatfac),'bcatfac',.true.)

      allocate (dhcr(nr), stat = ierr)
      dhcr=0.0d0
      call checkerr(ierr,'dhcr',ilog)
      call memory_monitor(sizeof(dhcr),'dhcr',.true.)

      allocate (eqr(nr,nthreads), stat = ierr)
      eqr=0.0d0
      call checkerr(ierr,'eqr',ilog)
      call memory_monitor(sizeof(eqr),'eqr',.true.)

      allocate (eqrs(nr), stat = ierr)
      eqrs=0.0d0
      call checkerr(ierr,'eqrs',ilog)
      call memory_monitor(sizeof(eqrs),'eqrs',.true.)

      allocate (chomc(nr*maxnor*nc), stat = ierr)
      chomc=0.0d0
      call checkerr(ierr,'chomc',ilog)
      call memory_monitor(sizeof(chomc),'chomc',.true.)

      allocate (chomt(nr*maxnor*nc), stat = ierr)
      chomt=0.0d0
      call checkerr(ierr,'chomc',ilog)
      call memory_monitor(sizeof(chomt),'chomt',.true.)

      allocate (chomx(nr*maxnor*nx), stat = ierr)
      chomx=0.0d0
      call checkerr(ierr,'chomx',ilog)
      call memory_monitor(sizeof(chomx),'chomx',.true.)

      allocate (ordorc(nr*maxnor*nc), stat = ierr)
      ordorc=0.0d0
      call checkerr(ierr,'ordorc',ilog)
      call memory_monitor(sizeof(ordorc),'ordorc',.true.)

      allocate (ordort(nr*maxnor*nc), stat = ierr)
      ordort=0.0d0
      call checkerr(ierr,'ordort',ilog)
      call memory_monitor(sizeof(ordort),'ordort',.true.)

      allocate (ordorx(nr*maxnor*nx), stat = ierr)
      ordorx=0.0d0
      call checkerr(ierr,'ordorx',ilog)
      call memory_monitor(sizeof(ordorx),'ordorx',.true.)

      allocate (rateor(nr,nthreads), stat = ierr)
      rateor=0.0d0
      call checkerr(ierr,'rateor',ilog)
      call memory_monitor(sizeof(rateor),'rateor',.true.)

      allocate (rateox(nr*maxnor), stat = ierr)
      rateox=0.0d0
      call checkerr(ierr,'rateox',ilog)
      call memory_monitor(sizeof(rateox),'rateox',.true.)

      allocate (xnur(nr*nc), stat = ierr)
      xnur=0.0d0
      call checkerr(ierr,'xnur',ilog)
      call memory_monitor(sizeof(xnur),'xnur',.true.)

      allocate (iaor(nr+1), stat = ierr)
      iaor=0 
      call checkerr(ierr,'iaor',ilog)
      call memory_monitor(sizeof(iaor),'iaor',.true.)

      allocate (iaorc(nr*maxnor+1), stat = ierr)
      iaorc=0
      call checkerr(ierr,'iaorc',ilog)
      call memory_monitor(sizeof(iaorc),'iaorc',.true.)

      allocate (iaort(nr*maxnor+1), stat = ierr)
      iaort=0
      call checkerr(ierr,'iaort',ilog)
      call memory_monitor(sizeof(iaort),'iaort',.true.)

      allocate (iaorx(nr*maxnor+1), stat = ierr)
      iaorx=0
      call checkerr(ierr,'iaorx',ilog)
      call memory_monitor(sizeof(iaorx),'iaorx',.true.)

      allocate (iarc(nr+1), stat = ierr)
      iarc=0
      call checkerr(ierr,'iarc',ilog)
      call memory_monitor(sizeof(iarc),'iarc',.true.)

      allocate (iars(nr), stat = ierr)
      iars=0
      call checkerr(ierr,'iars',ilog)
      call memory_monitor(sizeof(iars),'iars',.true.)

      allocate (jaorc(nr*maxnor*nc), stat = ierr)
      jaorc=0
      call checkerr(ierr,'jaorc',ilog)
      call memory_monitor(sizeof(jaorc),'jaorc',.true.)

      allocate (jaort(nr*maxnor*nc), stat = ierr)
      jaort=0
      call checkerr(ierr,'jaort',ilog)
      call memory_monitor(sizeof(jaort),'jaort',.true.)

      allocate (jaorx(nr*maxnor*nx), stat = ierr)
      jaorx=0
      call checkerr(ierr,'jaorx',ilog)
      call memory_monitor(sizeof(jaorx),'jaorx',.true.)

      allocate (jarc(nr*nc), stat = ierr)
      jarc=0
      call checkerr(ierr,'jarc',ilog)
      call memory_monitor(sizeof(jarc),'jarc',.true.)

      allocate (l_namer(nr), stat = ierr)
      l_namer=0
      call checkerr(ierr,'l_namer',ilog)
      call memory_monitor(sizeof(l_namer),'l_namer',.true.)

      allocate (l_namerp(nr), stat = ierr)
      l_namerp=0 
      call checkerr(ierr,'l_namerp',ilog)
      call memory_monitor(sizeof(l_namerp),'l_namerp',.true.)

      allocate (l_namers(nr), stat = ierr)
      l_namers=0 
      call checkerr(ierr,'l_namers',ilog)
      call memory_monitor(sizeof(l_namers),'l_namers',.true.)

      allocate (namer(nr), stat = ierr)
      namer=' '  
      call checkerr(ierr,'namer',ilog)
      call memory_monitor(sizeof(namer),'namer',.true.)

      allocate (namerp(nr), stat = ierr)
      namerp=' ' 
      call checkerr(ierr,'namerp',ilog)
      call memory_monitor(sizeof(namerp),'namerp',.true.)

      allocate (namers(nr), stat = ierr)
      namers=' ' 
      call checkerr(ierr,'namers',ilog)
      call memory_monitor(sizeof(namers),'namers',.true.)

      allocate (rtype_hom(nr), stat = ierr)
      rtype_hom=' '
      call checkerr(ierr,'rtype_hom',ilog)
      call memory_monitor(sizeof(rtype_hom),'rtype_hom',.true.)

      return
      end
