!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 826 $
!> $Author: dsu $
!> $Date: 2022-03-24 10:10:16 -0700 (Thu, 24 Mar 2022) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/multidiff.F90 $
!---------------------------------------------------------------------
!********************************************************************!

    
module multidiff

    use parm
    use geometry_definition
    
    implicit none

! prc -------------------------------------------------------------------
! defining the vectors for diffusion coefficients for primary and 
! secondary spices
! prc -------------------------------------------------------------------
    logical :: multi_diff = .false.
    logical :: hmulti_diff = .false.
    logical :: electric_field
    logical :: electric_field_file
    logical :: microporosity
      
    real (type_r8), allocatable :: mdiff_ic(:)         ! diffusion coefficient of free aqueous species
    real (type_r8), allocatable :: mdiff_ix(:)         ! diffusion coefficient of secondary aqueous complexes

!cdsu multicomponent diffusion coefficient tensor
    type(tensor), allocatable :: mdiff_ic_tensor(:)  ! diffusion coefficient of free aqueous species
    type(tensor), allocatable :: mdiff_ix_tensor(:)  ! diffusion coefficient of secondary aqueous complexes
    integer (type_i4) :: type_mdiff_ic_coeff
    integer (type_i4) :: type_mdiff_ix_coeff
      
    real (type_r8) :: diffcoff1
    real (type_r8) :: diffcoff2
      
    real (type_r8), allocatable :: cinfrt_mcd(:)       ! influence coeff for Multi-diff
                                                       ! in the aqueous phase
    real (type_r8), allocatable :: deltaij(:)          ! distance between i-j
    real (type_r8), allocatable :: tauij(:)            ! aqueous tortuosity at i-j
    real (type_r8), allocatable :: porij(:)            ! aqueous  porosity at i-j
    real (type_r8), allocatable :: satij(:)            ! aqueous saturation at i-j
    real (type_r8), allocatable :: dtotviscnew(:,:)    ! d (concentration * diffusion coef.) in current cvolume
    real (type_r8), allocatable :: delectromignew(:,:)
    
!    real (type_r8), allocatable :: elecmig(:)
!    real (type_r8), allocatable :: elecmig_pert(:)     
         
    real (type_r8), allocatable :: totviscnew(:,:)       ! concentration * diffusion coef. in each cvolume   
    real (type_r8), allocatable :: delta_totviscnew(:,:) ! d (concentration * diffusion coef.) in current cvolume

    real (type_r8), allocatable :: mdiff_ic_cvol(:,:)
    real (type_r8), allocatable :: mdiff_ix_cvol(:,:)

    type(tensor), allocatable :: mdiff_ic_cvol_tensor(:,:)
    type(tensor), allocatable :: mdiff_ix_cvol_tensor(:,:)
    
    real (type_r8), allocatable :: electromignew(:,:)
    real (type_r8), allocatable :: delta_electromignew(:,:)
    
    real (type_r8), allocatable :: electromignewMP(:,:)
    real (type_r8), allocatable :: electromignew_incMP(:,:)
    
    real (type_r8), allocatable :: totcnewMP(:,:)
    real (type_r8), allocatable :: totcoldMP(:,:)

    real (type_r8), allocatable :: driftnew(:,:)
    real (type_r8), allocatable :: ddriftnew(:)
    
!    real (type_r8), allocatable :: SumChargeMicropore(:)

    real (type_r8), allocatable :: DonnanPotentialTmp(:)  
      
! prc --------------------------------------------------------------------
! prc --------------------------------------------------------------------
! prc --------------------------------------------------------------------
 
 
 end module multidiff
