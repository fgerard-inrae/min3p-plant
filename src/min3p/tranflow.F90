!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/tranflow.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine tranflow
!c -------------------
!c
!c driver subroutine for transient flow 
!c
!c written by:      Uli Mayer - May 8, 96
!c
!c last modified:   Uli Mayer - December 6, 96
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:   
!c gen.f:    integer*4:
!c           ----------
!c           ilog               = unit number, log file               + -
!c           idetail_vs         = information level                   + -
!c                                (variably saturated flow)    
!c
!c           logical:
!c           --------
!c           fully_saturated    = .true.  -> saturated conditions     + -
!c           variably_saturated = .true.  -> .not.fully_saturated,    + -
!c                                        -> variably saturated
!c                                           conditions
!c
!c local:    - 
!c
!c external: fsflow    = driver subroutine for fully saturated 
!c                       flow 
!c           vsflow    = driver subroutine for variably saturated 
!c                       flow 
!c ----------------------------------------------------------------------

      subroutine tranflow

#ifdef PETSC
#include <petscversion.h>
#if (PETSC_VERSION_MAJOR >= 3 && PETSC_VERSION_MINOR >= 8)
#include <petsc/finclude/petscsys.h>
      use petscsys
#endif
#endif

      use parm
      use gen

      implicit none
      
#ifdef PETSC
#if (PETSC_VERSION_MAJOR >= 3 && PETSC_VERSION_MINOR >= 6 && PETSC_VERSION_MINOR < 8)
#include <petsc/finclude/petscsys.h>
#elif (PETSC_VERSION_MAJOR >= 3 && PETSC_VERSION_MINOR < 6)
#include <finclude/petscsys.h>
#endif
#endif

      integer :: i

      external fsflow, vsflow
      

      if(rank == 0 .and. b_enable_output) then      !if MPI rank 0

      if (idetail_vs.gt.0) then
        if (fully_saturated) then
          write(ilog,'(a)')'transient flow - saturated conditions'
        elseif (variably_saturated) then
          write(ilog,'(2a)')'transient flow - ',          &
     &                   'variably saturated conditions'
        end if
        write(ilog,'(72a/)')('-',i=1,72)
      end if

      end if                  !end if MPI rank 0


!c for saturated conditions

      if (fully_saturated) then
        call fsflow

!c for variably saturated conditions

      elseif (variably_saturated) then
        call vsflow
      end if

!c for decoupled heat transport
      if (.not. reduce_timestep) then
        if (heat_transport .and. decoupled_type_vs_heat > 1) then
          call heattran
        end if 
      end if

      return
      end
