!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/mem_evap.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_evap
!c ----------------- 
!c Sergio Andres Bea Jofre (2009)
!c
!c last modified:   -
!c
!c                  Danyang Su - Sept. 10, 2018
!c                  Unstructured grid and HPC capabilities
!c ----------------------------------------------------------------------
  
      subroutine mem_evap
       
      use parm
      use gen
      use chem
      use dens
#ifdef OPENMP
      use omp_lib 
#endif

      implicit none
      
      integer :: ierr

      external checkerr
      
      
 
!cprovi-----------------------------------------------------------
!cprovi Allocate variables corresponding to evaporation processes 
!cprovi----------------------------------------------------------- 


      allocate (densvnew(nngl), stat = ierr)
      densvnew=1.0d-3
      call checkerr(ierr,'densvnew',ilog)
      call memory_monitor(sizeof(densvnew),'densvnew',.true.)


      allocate (densvnewinc(nngl), stat = ierr)
      densvnewinc=0.0d0
      call checkerr(ierr,'densvnewinc',ilog)
      call memory_monitor(sizeof(densvnewinc),'densvnewinc',.true.)

  
      allocate (densvold(nngl), stat = ierr)
      densvold=1.0d-3
      call checkerr(ierr,'densvold',ilog)
      call memory_monitor(sizeof(densvold),'densvold',.true.)


      allocate (ddensvdpa(nngl), stat = ierr)
      ddensvdpa=0.0d0
      call checkerr(ierr,'ddensvdpa',ilog)
      call memory_monitor(sizeof(ddensvdpa),'ddensvdpa',.true.)


      allocate (ddensvdt(nngl), stat = ierr)
      ddensvdt=0.0d0
      call checkerr(ierr,'ddensvdt',ilog)
      call memory_monitor(sizeof(ddensvdt),'ddensvdt',.true.)


      allocate (dsurftensdt(nngl), stat = ierr)
      dsurftensdt=0.0d0
      call checkerr(ierr,'dsurftensdt',ilog)
      call memory_monitor(sizeof(dsurftensdt),'dsurftensdt',.true.)


      if (discretization_type == 0) then
        allocate (vapflux(ncon-1), stat = ierr)
        vapflux=0.0d0
        call checkerr(ierr,'vapflux',ilog)
        call memory_monitor(sizeof(vapflux),'vapflux',.true.)

        allocate (heatflux_v(ncon-1), stat = ierr)
        heatflux_v=0.0d0
        call checkerr(ierr,'heatflux_v',ilog)
        call memory_monitor(sizeof(heatflux_v),'heatflux_v',.true.)

        allocate (vapfluxheat(ncon-1), stat = ierr)
        vapfluxheat=0.0d0
        call checkerr(ierr,'vapfluxheat',ilog)
        call memory_monitor(sizeof(vapfluxheat),'vapfluxheat',.true.)

#ifdef USG
      else
        allocate (vapflux(ncon_usg-1), stat = ierr)
        vapflux=0.0d0
        call checkerr(ierr,'vapflux',ilog)
        call memory_monitor(sizeof(vapflux),'vapflux',.true.)

        allocate (heatflux_v(ncon_usg-1), stat = ierr)
        heatflux_v=0.0d0
        call checkerr(ierr,'heatflux_v',ilog)
        call memory_monitor(sizeof(heatflux_v),'heatflux_v',.true.)

        allocate (vapfluxheat(ncon_usg-1), stat = ierr)
        vapfluxheat=0.0d0
        call checkerr(ierr,'vapfluxheat',ilog)
        call memory_monitor(sizeof(vapfluxheat),'vapfluxheat',.true.)
#endif
      end if

      allocate (latvapnew(nngl), stat = ierr)
      latvapnew=0.0d0
      call checkerr(ierr,'latvapnew',ilog)
      call memory_monitor(sizeof(latvapnew),'latvapnew',.true.)


      allocate (latvapold(nngl), stat = ierr)
      latvapold=0.0d0
      call checkerr(ierr,'latvapold',ilog)
      call memory_monitor(sizeof(latvapold),'latvapold',.true.)

      return
      end
