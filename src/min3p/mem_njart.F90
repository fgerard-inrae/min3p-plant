!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/mem_njart.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_njart
!c --------------------
!c
!c allocate memory for one-dimensional arrays of size njart
!c
!c written by:      Uli Mayer - January 7, 2000
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:
!c gen.f:    integer*4:
!c           ----------
!c           ilog               = unit number, logbook file           + -
!c           iwork(:)           = integer work array                  * *
!c           jart(njart)        = connectivity list for n-d scalar    + +
!c                                matrix
!c           kart(njart)        = mapping pointer                     + +
!c                                (global block -> n-d scalar)
!c           njart              = number of global connections        + -
!c
!c local:    integer*4:
!c           ----------
!c           i1                 = pointer
!c           ierr               = 0 -> memory allocation successful
!c
!c external: checkerr  = check for error during memory allocation
!c
!c---------------------------------------------------------------------- 
!c WARNING
!c---------------------------------------------------------------------- 
!c All allocated variables are initialized to some value. This depends  
!c of its type:
!c 
!c real*8      => 0.0d0
!c integer     => 0 
!c character   => ' '    
!c logical     => .false. 
!c 
!c Sergio Andres Bea Jofre (2009)
!c
!c ----------------------------------------------------------------------
  
      subroutine mem_njart
 
      use parm
      use gen
      
      implicit none
      
      integer :: i1, ierr
 
      external checkerr

!c  allocate memory for one-dimensional arrays of size njart
      allocate (iwork(njart), stat = ierr)
      iwork=0
      call checkerr(ierr,'iwork',ilog)
      call memory_monitor(sizeof(iwork),'mem_njart-iwork',.true.)

!c  minimize memory requirements for array jart

      do i1 = 1,njart
        iwork(i1) = jart(i1)
      end do

      call memory_monitor(-sizeof(jart),'jart',.true.)
      deallocate (jart, stat = ierr)
      call checkerr(ierr,'jart',ilog)

      allocate (jart(njart), stat = ierr)
      jart=0
      call checkerr(ierr,'jart',ilog)
      call memory_monitor(sizeof(jart),'jart',.true.)

      do i1 = 1,njart
        jart(i1) = iwork(i1)
      end do

!c  minimize memory requirements for array kart

      do i1 = 1,njart
        iwork(i1) = kart(i1)
      end do

      call memory_monitor(-sizeof(kart),'kart',.true.)
      deallocate (kart, stat = ierr)
      call checkerr(ierr,'kart',ilog)

      allocate (kart(njart), stat = ierr)
      kart=0
      call checkerr(ierr,'kart',ilog)
      call memory_monitor(sizeof(kart),'kart',.true.)

      do i1 = 1,njart
        kart(i1) = iwork(i1)
      end do

!c  deallocate memory for one-dimensional arrays of size njart 
      call memory_monitor(-sizeof(iwork),'mem_njart-iwork',.true.)
      deallocate (iwork, stat = ierr)
      call checkerr(ierr,'iwork',ilog)

      return
      end
