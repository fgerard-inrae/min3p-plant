!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 850 $
!> $Author: dsu $
!> $Date: 2023-01-27 08:58:23 -0800 (Fri, 27 Jan 2023) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/mem_nm.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_nm
!c -----------------
!c
!c allocate memory for one-dimensional arrays of size nm and 
!c related arrays
!c
!c written by:      Uli Mayer - January 7, 2000
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:
!c gen.f:    integer:
!c           --------
!c           ilog               = unit number, logbook file           + -
!c
!c chem.f:   real*8:
!c           -------
!c           areac(nm)          = reactivity term                     * +
!c           areainit(nm)       = initial reactivity term             * +
!c           cmcnew(nm,nthreads)= concentration of minerals
!c                                - new time level [moles/l bulk]
!c           cmcold(nm)         = concentration of minerals           * +
!c                                - old time level [moles/l bulk]
!c           cmcmin(nm,nthreads)= min. concentration of minerals      * +
!c                                [moles/l bulk]
!c           densm(nm)          = densities of minerals               * +
!c           dgcm(nm)           = activation energy for               * +
!c                                dissolution-precipitation
!c                                reaction
!c           dhcm(nm)           = enthalpy change of dissolution-     * +
!c                                precipitation reaction
!c           diffm(ndr*nm,nthreads)
!c                              = free diffusion coefficient of       * +
!c                                primary reactant in water
!c                                (transport controlled reactions)
!c           dwcm(nm)           = activation enthalpy for transport
!c                                controlled dissolution-precipitation
!c                                reaction
!c                                (by dwilson November 24, 2015)
!c           diffms(ndr*nm)     = free diffusion coefficient of
!c                                primary reactant in water at
!c                                standard temperature
!c                                (by dwilson November 24, 2015)
!c           eqm(nm,nthreads)   = equilibrium constants for minerals  * +
!c           eqms(nm)           = equilibrium constants for minerals  * +
!c                                at standard temperature
!c           fmdi(nrc*nm)       = inhibition factors T^a              * +
!c           fmdm(nrc*nm)       = half saturation constants T^a       * +
!c           fmic(nrc*nm)       = inhibition factors C^c              * +
!c           fmhc(nrc*nm)       = half saturation constants C^c       * +
!c           fmdpi(nrc*nm)      = inhibition factors phi^m            * +
!c           fmdpm(nrc*nm)      = half saturation constants phi^m     * +
!c           expphi(nm)         = exponent for reactive surface area  * +
!c                                update
!c           sfac_sdmin(nm,nfac)= scale factor coeffients of minerals  
!c                                depending on salinity, nfac =10     * +
!c           gfwm(nm)           = gram formula weight of minerals     * +
!c           nfac(nm)           = number of coefficients of the 
!c                                  salinity dependent reaction      * +
!c           min_salinity(nm)   = minimum value of valid salinity 
!c                                 for salinity dependent reactions  * +
!c           min_sar(nm)        = minimum value of valid SAR
!c                                 for salinity dependent reactions  * +
!c           max_salinity(nm)   = maximum value of valid salinity 
!c                                 for salinity dependent reactions  * +
!c           max_sar(nm)        = maximum value of valid SAR
!c                                 for salinity dependent reactions  * +
!c           inamec_inhib(nm)   = The number of the component having
!c                                  strong inhibition effect.
!c           orddc(nrc*nm)      = order of dissolution-precipitation  * +
!c                                reaction with respect to
!c                                activities of components as species
!c                                in solution
!c           orddcx(nrc*nm)     = order of dissolution-precipitation  * +
!c                                reaction with respect to secondary
!c                                aqueous species activities
!c           orddt(nrc*nm)      = order of dissolution-precipitation  * +
!c                                reactions with respect to total
!c                                aqueous component concentrations
!c           ordm(ndr*nm)       = exponent m for reaction rate law    * +
!c           ordmdi(nrc*nm)     = order of inhibition terms for       * +
!c                                dissolution-precipitation reactions
!c                                T^a
!c           ordmdm(nrc*nm)     = order of hyperbolic terms for       * +
!c                                dissolution-precipitation reactions
!c                                T^a
!c           ordmic(nrc*nm)     = order of inhibition terms for       * +
!c                                dissolution-precipitation reactions
!c                                C^c
!c           ordmhc(nrc*nm)     = order of hyperbolic terms for       * +
!c                                dissolution-precipitation reactions
!c                                C^c
!c           ordmdpi(nrc*nm)    = order of inhibition terms for       * +
!c                                dissolution-precipitation reactions
!c                                phi^m
!c           ordmdpm(nrc*nm)    = order of hyperbolic terms for       * +
!c                                dissolution-precipitation reactions
!c                                phi^m
!c           ordn(ndr*nm)       = exponent n for reaction rate law    * +
!c           phic(nm,nthreads)  = volume fractions of minerals        * +
!c           phicold(nm,nthreads)     
!c                              = volume fractions of minerals        * +
!c                                - old time level
!c           radi(nm)           = initial radius of mineral particle  * +
!c           rads(nm,nthreads)  = radius of unreacted core of mineral * +
!c                                particle
!c           phimin(nm)         = volume fractions of minerals for    * +
!c                                nucleation
!c           phimin_out(nm)     = cutoff mineral volume fractions     * +
!c                                for output
!c           phiinit(nm,nthreads)   
!c                              = initial volume fractions of         * +
!c                                minerals
!c           phi_out(nm)        = mineral volume fractions for output * +
!c           radmin(nm)         = representative particle radius of   * +
!c                                nucleus
!c           satm(nm,nthreads)  = IAP/K for minerals                  * +
!c           satm_log(nm)       = saturation indices for minerals     * +
!c           supsatm(nm)        = level of supersaturation required   * +
!c                                for precipitation [log cycles]
!c           scalfac(nm)        = scaling factor (reactivity term)    * +
!c           rated(ndr*nm,nthreads)     
!c                              = rate constants for dissolution      * +
!c                                reactions
!c           rateds(ndr*nm)     = rate constants for dissolution-     * +
!c                                precipitation reactions at
!c                                standard temperature
!c           ratemp(ndr*nm,nthreads)
!c                              = reaction rates for minerals         * +
!c                                including parallel reactions
!c           totratem(nm,nthreads)
!c                              = total mineral dissolution-          * +
!c                                precipitation rate
!c           xnud(ndr*nm)       = stoichiometric coefficients of      * +
!c                                reacting species in transport
!c                                controlled dissolution reaction
!c           xnum(nm*nc)        = stoichiometric coefficients of      * +
!c                                components in mineral
!c                                components in excluded mineral
!c           ratedp(nm,nthreads)= absolute dissolution-precipitation  * +
!c                                rates of minerals
!c                                [moles/(l bulk*day)]
!c           dratedp(nm,nthreads)        
!c                              = derivatives of absolute             * +
!c                                dissolution-precipitation
!c                                rates of minerals
!c                                [moles/(l bulk*day)]
!c
!c           integer:
!c           --------
!c           iam(nm+1)          = row pointer array to                * +
!c                                stoichiometric coefficients of
!c                                components in mineral
!c           iamd(nm+1)         = pointer array to dissolution-       * +
!c                                precipitation reactions
!c           iamdc(ndr*nm+1)    = pointer array to components as      * +
!c                                species in solution involved in
!c                                dissolution-precipitation reactions
!c           iamdcx(ndr*nm+1)   = pointer array to secondary aqueous  * +
!c                                species involved in dissolution-
!c                                precipitation reactions
!c           iamdi(ndr*nm+1)    = row pointer array to reactants      * +
!c                                in dissolution-precipitation
!c                                reactions (inhibition terms T^a)
!c           iamdm(ndr*nm+1)    = row pointer array to reactants      * +
!c                                in dissolution-precipitation
!c                                reactions (hyperbolic terms T^a)
!c           iamic(ndr*nm+1)    = row pointer array to reactants      * +
!c                                in dissolution-precipitation
!c                                reactions (inhibition terms C^c)
!c           iamhc(ndr*nm+1)    = row pointer array to reactants      * +
!c                                in dissolution-precipitation
!c                                reactions (hyperbolic terms C^c)
!c           iamdpi(ndr*nm+1)   = row pointer array to reactants      * +
!c                                in dissolution-precipitation
!c                                reactions (inhibition terms phi^m) 
!c           iamdpm(ndr*nm+1)   = row pointer array to reactants      * +
!c                                in dissolution-precipitation
!c                                reactions (hyperbolic terms phi^m)
!c           iamdt(ndr*nm+1)    = pointer array to total aqueous      * +
!c                                component concentrations involved
!c                                in dissolution-precipitation
!c                                reactions
!c           iamp(nm+1)         = pointer array for distribution      * +
!c                                and combination of mineralogical
!c                                parameters
!c           jam(nm*nc)         = column pointer array to             * +
!c                                stoichiometric coefficients of
!c                                components in mineral
!c           jamd(nrc*nm)       = pointer array to parallel reactions + -
!c                                involved in dissolution reactions
!c           jamdc(nrc*nm)      = pointer array to components as      * +
!c                                species in solution involved in
!c                                dissolution-precipitation reactions
!c           jamdcx(nrc*nm)     = pointer array to secondary aqueous  * +
!c                                species involved in dissolution-
!c                                precipitation reactions
!c           jamdi(nrc*nm)      = column pointer array to reactants   * +
!c                                in dissolution-precipitation
!c                                reactions (inhibition terms T^a)
!c           jamdm(nrc*nm)      = column pointer array to reactants   * +
!c                                in dissolution-precipitation
!c                                reactions (hyperbolic terms T^a)
!c           jamic(nrc*nm)      = column pointer array to reactants   * +
!c                                in dissolution-precipitation
!c                                reactions (inhibition terms C^c)
!c           jamhc(nrc*nm)      = column pointer array to reactants   * +
!c                                in dissolution-precipitation
!c                                reactions (hyperbolic terms C^c)
!c           jamdpi(nrc*nm)     = column pointer array to reactants   * +
!c                                in dissolution-precipitation
!c                                reactions (inhibition terms phi^m)
!c           jamdpm(nrc*nm)     = column pointer array to reactants   * +
!c                                in dissolution-precipitation
!c                                reactions (hyperbolic terms phi^m)
!c           jamdt(nrc*nm)      = pointer array to total aqueous      * +
!c                                component concentrations involved
!c                                in dissolution-precipitation
!c                                reactions
!c           jamp(nm)           = pointer array for distribution      * +
!c                                and combination of mineralogical
!c                                parameters
!c           l_namem(nm)        = length of mineral names             * +
!c           l_namemp(ndr*nm)   = length of names of parallel         * +
!c                                dissolution-precipitation reactions
!c           nm                 = number of minerals                  + -
!c
!c           logical:
!c           --------
!c           far_from_equil(nm) = .true.  -> far from equilibrium     * +
!c           minequil(nm)       = .true.  -> equilibrate aqueous      * +
!c                                           species with specified
!c                                           mineral
!crevaff
!c           reverse_affinity_term(nm) = .true. -> reverse affinity   * +  
!c                                                 term if IAP/K > 1       
!crevaff
!c           salinity_dependent(nm) = .true. -> salinity dependent 
!c                                              mineral reaction
!c
!c           character:
!c           ----------
!c           namem(nm)          = mineral names                       * +
!c           namemp(ndr*nm)     = names for parallel                  * +
!c                                dissolution-precipitation reactions
!c           rate_control(nm)   = rate controlling process for        * +
!c                                dissolution-precipitation reaction
!c                                'surface'   = surface controlled
!c                                              reaction
!c                                'transport' = transport controlled
!c                                              reaction
!c                                'mixed'     = mixed control
!c           reaction_type(nm)  = reaction type of dissolution-       * +
!c                                precipitation reaction
!c           update_type(im)    = type of surface area update         * +
!c                                'constant'  = constant reactive
!c                                              surface area
!c                                'geometric' = geometric reactive
!c                                              surface area update
!c                                'twothird'  = two-third power
!c                                              expression
!c                                'exponent'  = user-specified power
!c                                              expression
!c          sdtype(nm)          = type of relation, two options
!c                                  'equation' sar=sum(f_i*salinity**(i-1)), 
!c                                      i=1,2,...,nfact)
!c                                   'points' experimental data  
!c                                      salinity, sar, linear interpolation
!c
!c local:    integer:
!c           --------
!c           ierr               = 0 -> memory allocation successful
!c
!c external: checkerr  = check for error during memory allocation
!c
!c---------------------------------------------------------------------- 
!c WARNING
!c---------------------------------------------------------------------- 
!c All allocated variables are initialized to some value. This depends  
!c of its type:
!c 
!c real*8      => 0.0d0
!c integer     => 0 
!c character   => ' '    
!c logical     => .false. 
!c 
!c Sergio Andres Bea Jofre (2009)
!c
!c ----------------------------------------------------------------------
  
      subroutine mem_nm
 
      use parm
      use gen
      use chem
      
      implicit none
      
      integer :: ierr
 
      external checkerr

!c  control parameters - local chemistry

      allocate (minequil(nm), stat = ierr)
      minequil=.false. 
      call checkerr(ierr,'minequil',ilog)
      call memory_monitor(sizeof(minequil),'minequil',.true.)

!c  main variables - minerals

      allocate (areac(nm), stat = ierr)
      areac=0.0d0
      call checkerr(ierr,'areac',ilog)
      call memory_monitor(sizeof(areac),'areac',.true.)

      allocate (areainit(nm), stat = ierr)
      areainit=0.0d0
      call checkerr(ierr,'areainit',ilog)
      call memory_monitor(sizeof(areainit),'areainit',.true.)

      allocate (cmcnew(nm,nthreads), stat = ierr)
      cmcnew=0.0d0
      call checkerr(ierr,'cmcnew',ilog)
      call memory_monitor(sizeof(cmcnew),'cmcnew',.true.)

      allocate (cmcold(nm,nthreads), stat = ierr)
      cmcold=0.0d0
      call checkerr(ierr,'cmcold',ilog)
      call memory_monitor(sizeof(cmcold),'cmcold',.true.)

      allocate (cmcmin(nm,nthreads), stat = ierr)
      cmcmin=0.0d0
      call checkerr(ierr,'cmcmin',ilog)
      call memory_monitor(sizeof(cmcmin),'cmcmin',.true.)

      allocate (dgcm(nm), stat = ierr)
      dgcm=0.0d0
      call checkerr(ierr,'dgcm',ilog)
      call memory_monitor(sizeof(dgcm),'dgcm',.true.)

      allocate (dhcm(nm), stat = ierr)
      dhcm=0.0d0
      call checkerr(ierr,'dhcm',ilog)
      call memory_monitor(sizeof(dhcm),'dhcm',.true.)

      allocate (dwcm(nm), stat = ierr)
      dwcm=0.0d0
      call checkerr(ierr,'dwcm',ilog)
      call memory_monitor(sizeof(dwcm),'dwcm',.true.)

      allocate (dscm(nm), stat = ierr)
      dscm=0.0d0
      call checkerr(ierr,'dscm',ilog)
      call memory_monitor(sizeof(dscm),'dwcm',.true.)

      allocate (expphi(nm), stat = ierr)
      expphi=0.0d0
      call checkerr(ierr,'expphi',ilog)
      call memory_monitor(sizeof(expphi),'expphi',.true.)
      
      allocate (phic(nm,nthreads), stat = ierr)
      phic=0.0d0
      call checkerr(ierr,'phic',ilog)
      call memory_monitor(sizeof(phic),'phic',.true.)

      allocate (phicold(nm,nthreads), stat = ierr)
      phicold=0.0d0
      call checkerr(ierr,'phicold',ilog)
      call memory_monitor(sizeof(phicold),'phicold',.true.)

      allocate (fmdi(maxnrc*nm), stat = ierr)
      fmdi=0.0d0
      call checkerr(ierr,'fmdi',ilog)
      call memory_monitor(sizeof(fmdi),'fmdi',.true.)

      allocate (fmdm(maxnrc*nm), stat = ierr)
      fmdm=0.0d0
      call checkerr(ierr,'fmdm',ilog)
      call memory_monitor(sizeof(fmdm),'fmdm',.true.)
      
!c_isotopes
          
      allocate (fmdsta(maxnrc*nm), stat = ierr)
      fmdsta=0.0d0
      call checkerr(ierr,'fmdsta',ilog)
      call memory_monitor(sizeof(fmdsta),'fmdsta',.true.)
      
      allocate (isofrac(nm), stat = ierr)
      isofrac = .false.
      call checkerr(ierr,'isofrac',ilog)
      call memory_monitor(sizeof(isofrac),'isofrac',.true.)
            
      allocate (isofracm(nm), stat = ierr)
      isofracm = .false.
      call checkerr(ierr,'isofracm',ilog)
      call memory_monitor(sizeof(isofracm),'isofracm',.true.)

      allocate (nifrm(nm), stat = ierr)
      nifrm=0
      call checkerr(ierr,'nifrm',ilog)
      call memory_monitor(sizeof(nifrm),'nifrm',.true.)
      
      allocate (fmic(maxnrc*nm), stat = ierr)
      fmic=0.0d0
      call checkerr(ierr,'fmic',ilog)
      call memory_monitor(sizeof(fmic),'fmic',.true.)

      allocate (fmhc(maxnrc*nm), stat = ierr)
      fmhc=0.0d0
      call checkerr(ierr,'fmhc',ilog)
      call memory_monitor(sizeof(fmhc),'fmhc',.true.)

      allocate (fmdpi(maxnrc*nm), stat = ierr)
      fmdpi=0.0d0
      call checkerr(ierr,'fmdpi',ilog)
      call memory_monitor(sizeof(fmdpi),'fmdpi',.true.)

      allocate (fmdpm(maxnrc*nm), stat = ierr)
      fmdpm=0.0d0
      call checkerr(ierr,'fmdpm',ilog)
      call memory_monitor(sizeof(fmdpm),'fmdpm',.true.)

      allocate (rads(nm,nthreads), stat = ierr)
      rads=0.0d0
      call checkerr(ierr,'rads',ilog)
      call memory_monitor(sizeof(rads),'rads',.true.)

      allocate (radi(nm), stat = ierr)
      radi=0.0d0
      call checkerr(ierr,'radi',ilog)
      call memory_monitor(sizeof(radi),'radi',.true.)

      allocate (phimin(nm), stat = ierr)
      phimin=0.0d0
      call checkerr(ierr,'phimin',ilog)
      call memory_monitor(sizeof(phimin),'phimin',.true.)

      allocate (phimin_out(nm), stat = ierr)
      phimin_out=0.0d0
      call checkerr(ierr,'phimin_out',ilog)
      call memory_monitor(sizeof(phimin_out),'phimin_out',.true.)

      allocate (phiinit(nm,nthreads), stat = ierr)
      phiinit=0.0d0
      call checkerr(ierr,'phiinit',ilog)
      call memory_monitor(sizeof(phiinit),'phiinit',.true.)
      
      allocate (phinuc(nm), stat = ierr)
      phinuc=0.0d0
      call checkerr(ierr,'phinuc',ilog)
      call memory_monitor(sizeof(phinuc),'phinuc',.true.)

      allocate (phi_out(nm), stat = ierr)
      phi_out=0.0d0
      call checkerr(ierr,'phi_out',ilog)
      call memory_monitor(sizeof(phi_out),'phi_out',.true.)

      allocate (radmin(nm), stat = ierr)
      radmin=0.0d0
      call checkerr(ierr,'radmin',ilog)
      call memory_monitor(sizeof(radmin),'radmin',.true.)

      allocate (supsatm(nm), stat = ierr)
      supsatm=0.0d0
      call checkerr(ierr,'supsatm',ilog)
      call memory_monitor(sizeof(supsatm),'supsatm',.true.)

      allocate (scalfac(nm), stat = ierr)
      scalfac=0.0d0
      call checkerr(ierr,'scalfac',ilog)
      call memory_monitor(sizeof(scalfac),'scalfac',.true.)
      
      allocate (sfac_sdmin(nm,10), stat = ierr)
      sfac_sdmin=1.0d0
      call checkerr(ierr,'sfac_sdmin',ilog)
      call memory_monitor(sizeof(sfac_sdmin),'sfac_sdmin',.true.)
      
      allocate (salinity_dependent(nm), stat = ierr)
      salinity_dependent=.false.
      call checkerr(ierr,'salinity_dependent',ilog)
      call memory_monitor(sizeof(salinity_dependent),'salinity_dependent',.true.)

      allocate (gfwm(nm), stat = ierr)
      gfwm=0.0d0
      call checkerr(ierr,'gfwm',ilog)
      call memory_monitor(sizeof(gfwm),'gfwm',.true.)

      allocate (diffm(maxndr*nm,nthreads), stat = ierr)
      diffm=0.0d0
      call checkerr(ierr,'diffm',ilog)
      call memory_monitor(sizeof(diffm),'diffm',.true.)

      allocate (diffms(maxndr*nm), stat = ierr)
      diffms=0.0d0
      call checkerr(ierr,'diffms',ilog)
      call memory_monitor(sizeof(diffms),'diffms',.true.)

      allocate (densm(nm), stat = ierr)
      densm=0.0d0
      call checkerr(ierr,'densm',ilog)
      call memory_monitor(sizeof(densm),'densm',.true.)

      allocate (eqm(nm,nthreads), stat = ierr)
      eqm=0.0d0
      call checkerr(ierr,'eqm',ilog)
      call memory_monitor(sizeof(eqm),'eqm',.true.)

      allocate (eqms(nm), stat = ierr)
      eqms=0.0d0
      call checkerr(ierr,'eqms',ilog)
      call memory_monitor(sizeof(eqms),'eqms',.true.)

      allocate (rated(maxndr*nm,nthreads), stat = ierr)
      rated=0.0d0
      call checkerr(ierr,'rated',ilog)
      call memory_monitor(sizeof(rated),'rated',.true.)

      allocate (rateds(maxndr*nm), stat = ierr)
      rateds=0.0d0
      call checkerr(ierr,'rateds',ilog)
      call memory_monitor(sizeof(rateds),'rateds',.true.)

      allocate (ratemp(maxndr*nm,nthreads), stat = ierr)
      ratemp=0.0d0
      call checkerr(ierr,'ratemp',ilog)
      call memory_monitor(sizeof(ratemp),'ratemp',.true.)
      
!c_bubbles
      allocate (dg_lim(nm), stat = ierr)
      dg_lim=1.0d0
      call checkerr(ierr,'dg_lim',ilog)
      call memory_monitor(sizeof(dg_lim),'dg_lim',.true.)
      
      allocate (orddc(maxnrc*nm), stat = ierr)
      orddc=0.0d0
      call checkerr(ierr,'orddc',ilog)
      call memory_monitor(sizeof(orddc),'orddc',.true.)

      allocate (orddcx(maxnrc*nm), stat = ierr)
      orddcx=0.0d0
      call checkerr(ierr,'orddcx',ilog)
      call memory_monitor(sizeof(orddcx),'orddcx',.true.)
      
!c_uranium
      allocate (orddscx(maxnrc*nm), stat = ierr)
      orddscx=0.0d0
      call checkerr(ierr,'orddscx',ilog)
      call memory_monitor(sizeof(orddscx),'orddscx',.true.)
      
      allocate (orddsumx(nm), stat = ierr)
      orddsumx=0.0d0
      call checkerr(ierr,'orddsumx',ilog)
      call memory_monitor(sizeof(orddsumx),'orddsumx',.true.)
      
!c_isotopes
      allocate (orddsta(maxnrc*nm), stat = ierr)
      orddsta=0.0d0
      call checkerr(ierr,'orddsta',ilog)
      call memory_monitor(sizeof(orddsta),'orddsta',.true.)
      
      allocate (orddt(maxnrc*nm), stat = ierr)
      orddt=0.0d0
      call checkerr(ierr,'orddt',ilog)
      call memory_monitor(sizeof(orddt),'orddt',.true.)

      allocate (ordm(maxndr*nm), stat = ierr)
      ordm=0.0d0
      call checkerr(ierr,'ordm',ilog)
      call memory_monitor(sizeof(ordm),'ordm',.true.)
      
      allocate (ordmdi(maxnrc*nm), stat = ierr)
      ordmdi=0.0d0
      call checkerr(ierr,'ordmdi',ilog)
      call memory_monitor(sizeof(ordmdi),'ordmdi',.true.)

      allocate (ordmdm(maxnrc*nm), stat = ierr)
      ordmdm=0.0d0
      call checkerr(ierr,'ordmdm',ilog)
      call memory_monitor(sizeof(ordmdm),'ordmdm',.true.)

      allocate (ordmic(maxnrc*nm), stat = ierr)
      ordmic=0.0d0
      call checkerr(ierr,'ordmic',ilog)
      call memory_monitor(sizeof(ordmic),'ordmic',.true.)

      allocate (ordmhc(maxnrc*nm), stat = ierr)
      ordmhc=0.0d0
      call checkerr(ierr,'ordmhc',ilog)
      call memory_monitor(sizeof(ordmhc),'ordmhc',.true.)

      allocate (ordmdpi(maxnrc*nm), stat = ierr)
      ordmdpi=0.0d0
      call checkerr(ierr,'ordmdpi',ilog)
      call memory_monitor(sizeof(ordmdpi),'ordmdpi',.true.)

      allocate (ordmdpm(maxnrc*nm), stat = ierr)
      ordmdpm=0.0d0
      call checkerr(ierr,'ordmdpm',ilog)
      call memory_monitor(sizeof(ordmdpm),'ordmdpm',.true.)
      
      allocate (ordmdphm(maxnrc*nm), stat = ierr)
      ordmdphm=0.0d0
      call checkerr(ierr,'ordmdphm',ilog)
      call memory_monitor(sizeof(ordmdphm),'ordmdphm',.true.)
      
      allocate (ordn(maxndr*nm), stat = ierr)
      ordn=0.0d0
      call checkerr(ierr,'ordn',ilog)
      call memory_monitor(sizeof(ordn),'ordn',.true.)

      allocate (totratem(nm,nthreads), stat = ierr)
      totratem=0.0d0
      call checkerr(ierr,'totratem',ilog)
      call memory_monitor(sizeof(totratem),'totratem',.true.)

      allocate (xnud(maxndr*nm), stat = ierr)
      xnud=0.0d0
      call checkerr(ierr,'xnud',ilog)
      call memory_monitor(sizeof(xnud),'xnud',.true.)

      allocate (xnum(nm*nc), stat = ierr)
      xnum=0.0d0
      call checkerr(ierr,'xnum',ilog)
      call memory_monitor(sizeof(xnum),'xnum',.true.)

      allocate (satm(nm,nthreads), stat = ierr)
      satm=0.0d0
      call checkerr(ierr,'satm',ilog)
      call memory_monitor(sizeof(satm),'satm',.true.)

      allocate (satm_log(nm), stat = ierr)
      satm_log=0.0d0
      call checkerr(ierr,'satm_log',ilog)
      call memory_monitor(sizeof(satm_log),'satm_log',.true.)

      allocate (iam(nm+1), stat = ierr)
      iam=0 
      call checkerr(ierr,'iam',ilog)
      call memory_monitor(sizeof(iam),'iam',.true.)

      allocate (iamd(nm+1), stat = ierr)
      iamd=0 
      call checkerr(ierr,'iamd',ilog)
      call memory_monitor(sizeof(iamd),'iamd',.true.)

      allocate (iamdc(maxndr*nm+1), stat = ierr)
      iamdc=0 
      call checkerr(ierr,'iamdc',ilog)
      call memory_monitor(sizeof(iamdc),'iamdc',.true.)

      allocate (iamdcx(maxndr*nm+1), stat = ierr)
      iamdcx=0 
      call checkerr(ierr,'iamdcx',ilog)
      call memory_monitor(sizeof(iamdcx),'iamdcx',.true.)

!c noble gas ingrowth
      allocate (iamdcm(maxndr*nm+1), stat = ierr)
      iamdcm=0
      call checkerr(ierr,'iamdcm',ilog)
      call memory_monitor(sizeof(iamdcm),'iamdcm',.true.)

      allocate (jamdcm(maxnrc*nm), stat = ierr)
      jamdcm=0
      call checkerr(ierr,'jamdcm',ilog)
      call memory_monitor(sizeof(jamdcm),'jamdcm',.true.)

      allocate (ordmdcm(maxnrc*nm), stat = ierr)
      ordmdcm=0.0d0
      call checkerr(ierr,'ordmdcm',ilog)
      call memory_monitor(sizeof(ordmdcm),'ordmdcm',.true.)

      allocate (orddm(maxnrc*nm), stat = ierr)
      orddm=0.0d0
      call checkerr(ierr,'orddm',ilog)
      call memory_monitor(sizeof(orddm),'orddm',.true.)     
!c_uranium

      allocate (iamdscx(maxndr*nm+1), stat = ierr)
      iamdscx=0
      call checkerr(ierr,'iamdscx',ilog)
      call memory_monitor(sizeof(iamdscx),'iamdscx',.true.)
      
!c_isotope

      allocate (iamdsta(maxndr*nm+1), stat = ierr)
      iamdsta=0
      call checkerr(ierr,'iamdsta',ilog)
      call memory_monitor(sizeof(iamdsta),'iamdsta',.true.)
      
      allocate (iamdsta2(maxndr*nm+1), stat = ierr)
      iamdsta2=0
      call checkerr(ierr,'iamdsta2',ilog)
      call memory_monitor(sizeof(iamdsta2),'iamdsta2',.true.)
      
      allocate (ntsc(maxndr*nm+1), stat = ierr)
      ntsc=0.0d0
      call checkerr(ierr,'ntsc',ilog)
      call memory_monitor(sizeof(ntsc),'ntsc',.true.)

      allocate (iamdiso(maxndr*nm+1), stat = ierr)
      iamdiso=0
      call checkerr(ierr,'iamdiso',ilog)
      call memory_monitor(sizeof(iamdiso),'iamdiso',.true.)
      
      allocate (iamdiso2(maxndr*nm+1), stat = ierr)
      iamdiso2=0
      call checkerr(ierr,'iamdiso2',ilog)
      call memory_monitor(sizeof(iamdiso2),'iamdiso2',.true.)
      
      allocate (iamdi(maxndr*nm+1), stat = ierr)
      iamdi=0 
      call checkerr(ierr,'iamdi',ilog)
      call memory_monitor(sizeof(iamdi),'iamdi',.true.)

      allocate (iamdm(maxndr*nm+1), stat = ierr)
      iamdm=0 
      call checkerr(ierr,'iamdm',ilog)
      call memory_monitor(sizeof(iamdm),'iamdm',.true.)
      
      allocate (iamic(maxndr*nm+1), stat = ierr)
      iamic=0 
      call checkerr(ierr,'iamic',ilog)
      call memory_monitor(sizeof(iamic),'iamic',.true.)
      
      allocate (iamhc(maxndr*nm+1), stat = ierr)
      iamhc=0 
      call checkerr(ierr,'iamhc',ilog)
      call memory_monitor(sizeof(iamhc),'iamhc',.true.)

      allocate (iamdpi(maxndr*nm+1), stat = ierr)
      iamdpi=0 
      call checkerr(ierr,'iamdpi',ilog)
      call memory_monitor(sizeof(iamdpi),'iamdpi',.true.)

      allocate (iamdpm(maxndr*nm+1), stat = ierr)
      iamdpm=0 
      call checkerr(ierr,'iamdpm',ilog)
      call memory_monitor(sizeof(iamdpm),'iamdpm',.true.)
      
      allocate (iamdphm(maxndr*nm+1), stat = ierr)
      iamdphm=0
      call checkerr(ierr,'iamdphm',ilog)
      call memory_monitor(sizeof(iamdphm),'iamdphm',.true.)
      
      allocate (iamdt(maxndr*nm+1), stat = ierr)
      iamdt=0 
      call checkerr(ierr,'iamdt',ilog)
      call memory_monitor(sizeof(iamdt),'iamdt',.true.)

      allocate (iamp(nm+1), stat = ierr)
      iamp=0 
      call checkerr(ierr,'iamp',ilog)
      call memory_monitor(sizeof(iamp),'iamp',.true.)

      allocate (jam(nm*nc), stat = ierr)
      jam=0
      call checkerr(ierr,'jam',ilog)
      call memory_monitor(sizeof(jam),'jam',.true.)
      
      allocate (jamd(maxnrc*nm), stat = ierr)
      jamd=0
      call checkerr(ierr,'jamd',ilog)
      call memory_monitor(sizeof(jamd),'jamd',.true.)

      allocate (jamdc(maxnrc*nm), stat = ierr)
      jamdc=0                                      !MX
      call checkerr(ierr,'jamdc',ilog)
      call memory_monitor(sizeof(jamdc),'jamdc',.true.)

      allocate (jamdcx(maxnrc*nm), stat = ierr)
      jamdcx=0
      call checkerr(ierr,'jamdcx',ilog)
      call memory_monitor(sizeof(jamdcx),'jamdcx',.true.)
      
!c_uranium
      allocate (jamdscx(maxnrc*nm), stat = ierr)
      jamdscx=0
      call checkerr(ierr,'jamdscx',ilog)
      call memory_monitor(sizeof(jamdscx),'jamdscx',.true.)
      
!c_isotope
      allocate (jamdsta(maxnrc*nm), stat = ierr)
      jamdsta=0
      call checkerr(ierr,'jamdsta',ilog)
      call memory_monitor(sizeof(jamdsta),'jamdsta',.true.)
      
      allocate (jamdiso(maxnrc*nm), stat = ierr)
      jamdiso=0
      call checkerr(ierr,'jamdiso',ilog)
      call memory_monitor(sizeof(jamdiso),'jamdiso',.true.)
      
      allocate (jamdiso2(maxnrc*nm), stat = ierr)
      jamdiso2=0
      call checkerr(ierr,'jamdiso2',ilog)
      call memory_monitor(sizeof(jamdiso2),'jamdiso2',.true.)
      
      allocate (jamdalpha(maxnrc*nm), stat = ierr)
      jamdalpha=0.0d0
      call checkerr(ierr,'jamdalpha',ilog)
      call memory_monitor(sizeof(jamdalpha),'jamdalpha',.true.)
      
      allocate (jamdpair(maxnrc*nm), stat = ierr)
      jamdpair=0
      call checkerr(ierr,'jamdpair',ilog)
      call memory_monitor(sizeof(jamdpair),'jamdpair',.true.)
      
      allocate (jamdi(maxnrc*nm), stat = ierr)
      jamdi=0
      call checkerr(ierr,'jamdi',ilog)
      call memory_monitor(sizeof(jamdi),'jamdi',.true.)

      allocate (jamdm(maxnrc*nm), stat = ierr)
      jamdm=0
      call checkerr(ierr,'jamdm',ilog)
      call memory_monitor(sizeof(jamdm),'jamdm',.true.)
      
      allocate (jamic(maxnrc*nm), stat = ierr)
      jamic=0
      call checkerr(ierr,'jamic',ilog)
      call memory_monitor(sizeof(jamic),'jamic',.true.)

      allocate (jamhc(maxnrc*nm), stat = ierr)
      jamhc=0
      call checkerr(ierr,'jamhc',ilog)
      call memory_monitor(sizeof(jamhc),'jamhc',.true.)
      
      allocate (jamdpi(maxnrc*nm), stat = ierr)
      jamdpi=0
      call checkerr(ierr,'jamdpi',ilog)
      call memory_monitor(sizeof(jamdpi),'jamdpi',.true.)

      allocate (jamdpm(maxnrc*nm), stat = ierr)
      jamdpm=0
      call checkerr(ierr,'jamdpm',ilog)
      call memory_monitor(sizeof(jamdpm),'jamdpm',.true.)
      
      allocate (jamdphm(maxnrc*nm), stat = ierr)
      jamdphm=0
      call checkerr(ierr,'jamdpm',ilog)
      call memory_monitor(sizeof(jamdphm),'jamdphm',.true.)
      
      allocate (jamdt(maxnrc*nm), stat = ierr)
      jamdt=0
      call checkerr(ierr,'jamdt',ilog)
      call memory_monitor(sizeof(jamdt),'jamdt',.true.)

      allocate (jamp(nm), stat = ierr)
      jamp=0
      call checkerr(ierr,'jamp',ilog)
      call memory_monitor(sizeof(jamp),'jamp',.true.)

      allocate (l_namem(nm), stat = ierr)
      l_namem=0 
      call checkerr(ierr,'l_namem',ilog)
      call memory_monitor(sizeof(l_namem),'l_namem',.true.)

      allocate (l_namemp(maxndr*nm), stat = ierr)
      l_namemp= 0
      call checkerr(ierr,'l_namemp',ilog)
      call memory_monitor(sizeof(l_namemp),'l_namemp',.true.)
      
      allocate (nfac(nm), stat = ierr)
      nfac=0
      call checkerr(ierr,'nfac',ilog) 
      call memory_monitor(sizeof(nfac),'nfac',.true.)
      
      allocate (min_salinity(nm), stat = ierr)
      min_salinity=0.0d0
      call checkerr(ierr,'min_salinity',ilog)
      call memory_monitor(sizeof(min_salinity),'min_salinity',.true.)
      
!c           inamec_inhib(nm)   = The number of the component having
!c                                strong inhibition effect.
      allocate (min_sar(nm), stat = ierr)
      min_sar=0.0d0
      call checkerr(ierr,'min_sar',ilog)
      call memory_monitor(sizeof(min_sar),'min_sar',.true.)
      
      allocate (max_salinity(nm), stat = ierr)
      max_salinity=0.0d0
      call checkerr(ierr,'max_salinity',ilog)
      call memory_monitor(sizeof(max_salinity),'max_salinity',.true.)
      
      allocate (max_sar(nm), stat = ierr)
      max_sar=0.0d0
      call checkerr(ierr,'max_sar',ilog)
      call memory_monitor(sizeof(max_sar),'max_sar',.true.)
      
      allocate (inamec_inhib(nm), stat = ierr)
      inamec_inhib=0
      call checkerr(ierr,'inamec_inhib',ilog)
      call memory_monitor(sizeof(inamec_inhib),'inamec_inhib',.true.)

      allocate (far_from_equil(nm), stat = ierr)
      far_from_equil= .false.
      call checkerr(ierr,'far_from_equil',ilog)
      call memory_monitor(sizeof(far_from_equil),'far_from_equil',.true.)

!crevaff      
      allocate (reverse_affinity_term(nm), stat = ierr)
      reverse_affinity_term=.false.
      call checkerr(ierr,'reverse_affinity_term',ilog)
      call memory_monitor(sizeof(reverse_affinity_term),'reverse_affinity_term',.true.)
!creavaff       

      allocate (namem(nm), stat = ierr)
      namem=' ' 
      call checkerr(ierr,'namem',ilog)
      call memory_monitor(sizeof(namem),'namem',.true.)

      allocate (rate_control(nm), stat = ierr)
      rate_control=' ' 
      call checkerr(ierr,'rate_control',ilog)
      call memory_monitor(sizeof(rate_control),'rate_control',.true.)

      allocate (update_type(nm), stat = ierr)
      update_type=' '  
      call checkerr(ierr,'update_type',ilog)
      call memory_monitor(sizeof(update_type),'update_type',.true.)
      
      allocate (sdtype(nm), stat = ierr)
      sdtype=' '  
      call checkerr(ierr,'sdtype',ilog)
      call memory_monitor(sizeof(sdtype),'sdtype',.true.)

      allocate (namemp(maxndr*nm), stat = ierr)
      namemp=' ' 
      call checkerr(ierr,'namemp',ilog)
      call memory_monitor(sizeof(namemp),'namemp',.true.)

      allocate (reaction_type(nm), stat = ierr)
      reaction_type=' ' 
      call checkerr(ierr,'reaction_type',ilog)
      call memory_monitor(sizeof(reaction_type),'reaction_type',.true.)

!c  newton iteration

      allocate (ratedp(nm,nthreads), stat = ierr)
      ratedp=0.0d0
      call checkerr(ierr,'ratedp',ilog)
      call memory_monitor(sizeof(ratedp),'ratedp',.true.)

      allocate (dratedp(nm,nthreads), stat = ierr)
      dratedp=0.0d0
      call checkerr(ierr,'dratedp',ilog)
      call memory_monitor(sizeof(dratedp),'dratedp',.true.)
      
!c  reaction rate due to saturation correction      
      allocate (satcorr_flag(nm), stat = ierr)
      satcorr_flag=.false. 
      call checkerr(ierr,'satcorr_flag',ilog)
      call memory_monitor(sizeof(satcorr_flag),'satcorr_flag',.true.)      
      
!c  mineral water removal
      allocate (rwaterremovalcoeff(nm), stat = ierr)
      rwaterremovalcoeff=0.0d0 
      call checkerr(ierr,'rwaterremovalcoeff',ilog)
      call memory_monitor(sizeof(rwaterremovalcoeff),'rwaterremovalcoeff',.true.)
      
!c_bubbles

      allocate (pressure_approximation(nm), stat = ierr)
      pressure_approximation = .false.
      call checkerr(ierr,'pressure_approximation',ilog)
      call memory_monitor(sizeof(pressure_approximation),'pressure_approximation',.true.)

!c sung-wook's (Dec. 8/2003)
    
      allocate (sur_prec(nm), stat = ierr)
      sur_prec = .false.
      call checkerr(ierr,'sur_prec',ilog)
      call memory_monitor(sizeof(sur_prec),'sur_prec',.true.)

      
      allocate (alph_prec(nm), stat = ierr)
      alph_prec=0.0d0
      call checkerr(ierr,'alph_prec',ilog)
      call memory_monitor(sizeof(alph_prec),'alph_prec',.true.)

!c    scaling factor for mineral reactivity
      allocate (scalfac_min(nm), stat = ierr)
      scalfac_min=1.0d0
      call checkerr(ierr,'scalfac_min',ilog)
      call memory_monitor(sizeof(scalfac_min),'scalfac_min',.true.)
      
      return
      end
