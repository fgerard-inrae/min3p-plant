!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 826 $
!> $Author: dsu $
!> $Date: 2022-03-24 10:10:16 -0700 (Thu, 24 Mar 2022) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/mem_ng.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_ng
!c -----------------
!c
!c allocate memory for one-dimensional arrays of size ng and related 
!c arrays
!c
!c written by:      Uli Mayer - January 7, 2000
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:
!c gen.f:    integer:
!c           --------
!c           ilog               = unit number, logbook file           + -
!c
!c chem.f:   real*8:
!c           -------
!c           cgc(ng)            = gas concentrations                  * +
!c                                - new time level [moles/l air]
!c           dhcg(ng)           = enthalpy change for gases           * +
!c           eqg(ng,nthreads)   = equilibrium constants for gases     * +
!c           eqgs(ng)           = equilibrium constants for gases     * +
!c                                at standard temperature
!c           gfwg(ng)           = gram formula weight for gases       * +
!c           rateg(ng,nthreads) = degassing rates                     * +
!c           xnug(ng*nc)        = stoichiometric coefficient matrix   * +
!c                                for formation of gases from
!c                                components
!c           ginc(ng,nthreads)  = gas concentrations dependent on     * +
!c                                incremented concentrations of
!c                                components as species in solution
!c                                [moles/l air]
!c
!c           integer:
!c           --------
!c           iaga(ng+1)         = row pointer array to                * +
!c                                stoichiometric coefficients of
!c                                components in gases
!c           jaga(ng*nc)        = column pointer array to             * +
!c                                stoichiometric coefficients of      * +
!c                                components in gases
!c           l_nameg(ng)        = length of names of gases            * +
!c           nc                 = number of components including h2o  + -
!c           ng                 = number of gases                     + -
!c
!c           character:
!c           ----------
!c           nameg(ng)          = names of gases                      * +
!c phys.f:   real*8:
!c           -------
!c           visc_comp_g(ng)    = viscosity of gas species            + -
!c           diff_bin_g(ng,ng)  = binary gas diffusion coeff          + -
!c
!c
!c local:    integer:
!c           --------
!c           ierr               = 0 -> memory allocation successful
!c
!c external: checkerr  = check for error during memory allocation
!c---------------------------------------------------------------------- 
!c WARNING
!c---------------------------------------------------------------------- 
!c All allocated variables are initialized to some value. This depends  
!c of its type:
!c 
!c real*8      => 0.0d0
!c integer     => 0 
!c character   => ' '    
!c logical     => .false. 
!c 
!c Sergio Andres Bea Jofre (2009)
!c
!c ----------------------------------------------------------------------
  
      subroutine mem_ng
 
      use parm
      use gen
      use chem
      use bbls
      use phys, only : visc_comp_g, diff_bin_g
      
      implicit none
      
      integer :: ierr
 
      external checkerr

!c  main variables - gases     
      if (ng < 1) then
        !cgc is allocate because it is used in some function as a dummy
        !parameter even ng < 0. This will cause runtime error for some
        !compiler if cgc is not allocated.
        allocate (cgc(1), stat = ierr)
        cgc=0.0d0
        call checkerr(ierr,'cgc',ilog)
        return
      end if

      allocate (cgc(ng), stat = ierr)
      cgc=0.0d0 
      call checkerr(ierr,'cgc',ilog)
      call memory_monitor(sizeof(cgc),'cgc',.true.)

      allocate (gfwg(ng), stat = ierr)
      gfwg=0.0d0
      call checkerr(ierr,'gfwg',ilog)
      call memory_monitor(sizeof(gfwg),'gfwg',.true.)

      allocate (eqg(ng,nthreads), stat = ierr)
      eqg=0.0d0
      call checkerr(ierr,'eqg',ilog)
      call memory_monitor(sizeof(eqg),'eqg',.true.)

      allocate (eqgs(ng), stat = ierr)
      eqgs=0.0d0
      call checkerr(ierr,'eqgs',ilog)
      call memory_monitor(sizeof(eqgs),'eqgs',.true.)

      allocate (dhcg(ng), stat = ierr)
      dhcg=0.0d0
      call checkerr(ierr,'dhcg',ilog)
      call memory_monitor(sizeof(dhcg),'dhcg',.true.)

      allocate (rateg(ng,nthreads), stat = ierr)
      rateg=0.0d0
      call checkerr(ierr,'rateg',ilog)
      call memory_monitor(sizeof(rateg),'rateg',.true.)

      allocate (xnug(ng*nc), stat = ierr)
      xnug=0.0d0
      call checkerr(ierr,'xnug',ilog)
      call memory_monitor(sizeof(xnug),'xnug',.true.)

      allocate (iaga(ng+1), stat = ierr)
      iaga=0 
      call checkerr(ierr,'iaga',ilog)
      call memory_monitor(sizeof(iaga),'iaga',.true.)

      allocate (jaga(ng*nc), stat = ierr)
      jaga=0
      call checkerr(ierr,'jaga',ilog)
      call memory_monitor(sizeof(jaga),'jaga',.true.)

      allocate (l_nameg(ng), stat = ierr)
      l_nameg=0 
      call checkerr(ierr,'l_nameg',ilog)
      call memory_monitor(sizeof(l_nameg),'l_nameg',.true.)

      allocate (nameg(ng), stat = ierr)
      nameg='  '
      call checkerr(ierr,'nameg',ilog)
      call memory_monitor(sizeof(nameg),'nameg',.true.)
      
!c  compositional approach

      allocate (visc_comp_g(ng), stat = ierr)
      visc_comp_g = 0.0d0
      call checkerr(ierr,'visc_comp_g',ilog) 
      call memory_monitor(sizeof(visc_comp_g),'visc_comp_g',.true.)
      
      allocate (diff_bin_g(ng,ng), stat = ierr)
      diff_bin_g = 0.0d0
      call checkerr(ierr,'diff_bin_g',ilog)
      call memory_monitor(sizeof(diff_bin_g),'diff_bin_g',.true.)

!c  newton iteration

      allocate (ginc(ng,nthreads), stat = ierr)
      ginc=0.0d0 
      call checkerr(ierr,'ginc',ilog)
      call memory_monitor(sizeof(ginc),'ginc',.true.)
      
!c_bubbles temperature corrections
      allocate (gas_type(ng), stat = ierr)
      gas_type = ""
      call checkerr(ierr,'gas_type',ilog)
      call memory_monitor(sizeof(gas_type),'gas_type',.true.)
      
      allocate (gascon_a(ng), stat = ierr)
      gascon_a=0.0d0
      call checkerr(ierr,'gascon_a',ilog)
      call memory_monitor(sizeof(gascon_a),'gascon_a',.true.)
            
      allocate (gascon_b(ng), stat = ierr)
      gascon_b=0.0d0
      call checkerr(ierr,'gascon_b',ilog)
      call memory_monitor(sizeof(gascon_b),'gascon_b',.true.)
            
      allocate (gascon_c(ng), stat = ierr)
      gascon_c=0.0d0
      call checkerr(ierr,'gascon_c',ilog)
      call memory_monitor(sizeof(gascon_c),'gascon_c',.true.)

!c  gas decay approach
      allocate (gasdecayconst(ng), stat = ierr)
      gasdecayconst=0.0d0
      call checkerr(ierr,'gasdecayconst',ilog)
      call memory_monitor(sizeof(gasdecayconst),'gasdecayconst',.true.)

      allocate (gasdecayrate(ng), stat = ierr)
      gasdecayrate=0.0d0
      call checkerr(ierr,'gasdecayrate',ilog)
      call memory_monitor(sizeof(gasdecayrate),'gasdecayrate',.true.)

      allocate (dgasdecayrate(ng), stat = ierr)
      dgasdecayrate=0.0d0
      call checkerr(ierr,'dgasdecayrate',ilog)
      call memory_monitor(sizeof(dgasdecayrate),'dgasdecayrate',.true.)
      
      !c size of gasdecayratetot is n
      allocate (gasdecayratetot(n), stat = ierr)
      gasdecayratetot=0.0d0
      call checkerr(ierr,'gasdecayratetot',ilog)
      call memory_monitor(sizeof(gasdecayratetot),'gasdecayratetot',.true.)

      return
      end
