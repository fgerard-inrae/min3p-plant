!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 879 $
!> $Author: dsu $
!> $Date: 2024-02-17 10:15:21 -0800 (Sat, 17 Feb 2024) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/binmatevap.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ---------------------------------------------------------------------- 
!c subroutine binmatevap
!c -------------------
!c
!c assign binary values to matrix localizing control volume subjected to 
!c evaporation (h1dry based)
!c
!c written by:      Frederic Gerard - May, 08
!c
!c last modified:   Celine Blitz Frayret (CBF) for Frédéric Gérard (FG) - December 14, 2018
!c    updates in the comments of the variables
!c 
!c definition of variables: 
!c 
!c common:    
!c 
!c gen.f:    integer: 
!c           -------- 
!c           mpropvs(nn)    = pointer array for allocation of  
!c                            material properties 
!c phys.f:   real*8: 
!c           -------  
!c           h1dry(nzn)     = air-dry aqueous pressure 
!c
!c biol.F90: logical: 
!c           --------  
!c           BINev(nn)      = binary matrix of track control volume 
!c                            subjected to evaporation 
!c
!c local:    real*8:
!c     -------
!c           r0                 = constant
!c
!c     integer*4:
!c           ----------
!c           ivol               = counter (control volumes) CBF
!c           izn                = pointer to material property zone  CBF
!c
!c ---------------------------------------------------------------------- 
    subroutine binmatevap
  
      use gen 
      use phys
      use biol 
#ifdef OPENMP
      use omp_lib 
#endif 

      implicit none
 
      integer :: ivol, izn !CBF
      real*8, parameter :: r0 = 0.0d0 


!c build binary matrix for evaporation
!cdsu this part is never used, comment

!c       if (soilhydrfunc_field) then
!c #ifdef OPENMP
!c     !$omp parallel                                                    &
!c     !$omp if (nngl > numofloops_thred_global)                         &
!c     !$omp num_threads(numofthreads_global)                            &
!c     !$omp default(shared)                                             &
!c     !$omp private (ivol)
!c     !$omp do schedule(static)
!c #endif
!c         do ivol=1,nngl
!c
!c           BINev(ivol)=.false.
!c
!c           if (h1dry_vol(ivol).gt.r0) then
!c             BINev(ivol)= .true.
!c           else
!c             BINev(ivol)= .false.
!c           endif
!c
!c         enddo
!c #ifdef OPENMP
!c     !$omp end do
!c     !$omp end parallel
!c #endif
!c       else
!c #ifdef OPENMP
!c     !$omp parallel                                                    &
!c     !$omp if (nngl > numofloops_thred_global)                         &
!c     !$omp num_threads(numofthreads_global)                            &
!c     !$omp default(shared)                                             &
!c     !$omp private (ivol,izn)
!c     !$omp do schedule(static)
!c #endif
!c         do ivol=1,nngl
!c
!c           izn=mpropvs(ivol)
!c
!c
!c           BINev(ivol)=.false.
!c
!c           if (h1dry(izn).gt.r0) then
!c             BINev(ivol)= .true.
!c           else
!c             BINev(ivol)= .false.
!c           endif
!c
!c         enddo
!c #ifdef OPENMP
!c     !$omp end do
!c     !$omp end parallel
!c #endif
!c       end if

      return
 
     end

